import{a as ae,b as D,c as K,d as y,e as b,f as O,g as E,h as P,i as Y,j as w,k as H,l as v,m as U,n as j,p as q}from"./chunk-F374AMMG.mjs";import{a as T}from"./chunk-YHYZJ2SB.mjs";import"./chunk-2FGXC5OW.mjs";import{a as se}from"./chunk-GRJJJ4OW.mjs";import"./chunk-FCPC5BCO.mjs";import{a as N,b as p,d as A,e as I,t as B}from"./chunk-T5KSJHJ6.mjs";import{b as ne}from"./chunk-APO7Z5NW.mjs";import"./chunk-H7IMS2NS.mjs";import"./chunk-TX7HZ4JG.mjs";import{a,f as h,i as f}from"./chunk-6HUL6TUM.mjs";f();var R=h(N());f();var k=h(N());var W=h(ae()),{window:n,document:m,location:F}=k.default,M="storybook-channel",ie={allowFunction:!0,maxDepth:25},S=class{constructor(e){if(this.config=e,this.buffer=void 0,this.handler=void 0,this.connected=void 0,this.buffer=[],this.handler=null,n&&n.addEventListener("message",this.handleEvent.bind(this),!1),e.page!=="manager"&&e.page!=="preview")throw new Error(`postmsg-channel: "config.page" cannot be "${e.page}"`)}setHandler(e){this.handler=(...t)=>{e.apply(this,t),!this.connected&&this.getLocalFrame().length&&(this.flush(),this.connected=!0)}}send(e,t){let{target:o,allowRegExp:r,allowFunction:i,allowSymbol:c,allowDate:l,allowUndefined:d,allowClass:Q,maxDepth:X,space:Z,lazyEval:ee}=t||{},te=Object.fromEntries(Object.entries({allowRegExp:r,allowFunction:i,allowSymbol:c,allowDate:l,allowUndefined:d,allowClass:Q,maxDepth:X,space:Z,lazyEval:ee}).filter(([u,g])=>typeof g<"u")),x=Object.assign({},ie,k.default.CHANNEL_OPTIONS||{},te);t&&Number.isInteger(t.depth)&&(x.maxDepth=t.depth);let $=this.getFrames(o),re=W.default.parse(F.search,{ignoreQueryPrefix:!0}),oe=O({key:M,event:e,refId:re.refId},x);return $.length?(this.buffer.length&&this.flush(),$.forEach(u=>{try{u.postMessage(oe,"*")}catch{console.error("sending over postmessage fail")}}),Promise.resolve(null)):new Promise((u,g)=>{this.buffer.push({event:e,resolve:u,reject:g})})}flush(){let{buffer:e}=this;this.buffer=[],e.forEach(t=>{this.send(t.event).then(t.resolve).catch(t.reject)})}getFrames(e){if(this.config.page==="manager"){let o=[...m.querySelectorAll("iframe[data-is-storybook][data-is-loaded]")].filter(r=>{try{return!!r.contentWindow&&r.dataset.isStorybook!==void 0&&r.id===e}catch{return!1}}).map(r=>r.contentWindow);return o.length?o:this.getCurrentFrames()}return n&&n.parent&&n.parent!==n?[n.parent]:[]}getCurrentFrames(){return this.config.page==="manager"?[...m.querySelectorAll('[data-is-storybook="true"]')].map(t=>t.contentWindow):n&&n.parent?[n.parent]:[]}getLocalFrame(){return this.config.page==="manager"?[...m.querySelectorAll("#storybook-preview-iframe")].map(t=>t.contentWindow):n&&n.parent?[n.parent]:[]}handleEvent(e){try{let{data:t}=e,{key:o,event:r,refId:i}=typeof t=="string"&&b(t)?E(t,k.default.CHANNEL_OPTIONS||{}):t;if(o===M){let c=this.config.page==="manager"?'<span style="color: #37D5D3; background: black"> manager </span>':'<span style="color: #1EA7FD; background: black"> preview </span>',l=Object.values(y).includes(r.type)?`<span style="color: #FF4785">${r.type}</span>`:`<span style="color: #FFAE00">${r.type}</span>`;if(i&&(r.refId=i),r.source=this.config.page==="preview"?e.origin:ce(e),!r.source){A.error(`${c} received ${l} but was unable to determine the source of the event`);return}let d=`${c} received ${l} (${t.length})`;A.debug(F.origin!==r.source?d:`${d} <span style="color: gray">(on ${F.origin} from ${r.source})</span>`,...r.args),this.handler(r)}}catch(t){p.error(t)}}};a(S,"PostmsgTransport");var ce=a(s=>{let e=[...m.querySelectorAll("iframe[data-is-storybook]")],[t,...o]=e.filter(r=>{try{return r.contentWindow===s.source}catch{}let i=r.getAttribute("src"),c;try{({origin:c}=new URL(i,m.location))}catch{return!1}return c===s.origin});if(t&&o.length===0){let r=t.getAttribute("src"),{protocol:i,host:c,pathname:l}=new URL(r,m.location);return`${i}//${c}${l}`}return o.length>0&&p.error("found multiple candidates for event source"),null},"getEventSourceUrl");function _({page:s}){let e=new S({page:s});return new w({transport:e})}a(_,"createChannel");f();var V=h(N());var{WebSocket:fe}=V.default,C=class{constructor({url:e,onError:t}){this.socket=void 0,this.handler=void 0,this.buffer=[],this.isReady=!1,this.connect(e,t)}setHandler(e){this.handler=e}send(e){this.isReady?this.sendNow(e):this.sendLater(e)}sendLater(e){this.buffer.push(e)}sendNow(e){let t=O(e,{maxDepth:15,allowFunction:!0});this.socket.send(t)}flush(){let{buffer:e}=this;this.buffer=[],e.forEach(t=>this.send(t))}connect(e,t){this.socket=new fe(e),this.socket.onopen=()=>{this.isReady=!0,this.flush()},this.socket.onmessage=({data:o})=>{let r=typeof o=="string"&&b(o)?E(o):o;this.handler(r)},this.socket.onerror=o=>{t&&t(o)}}};a(C,"WebsocketTransport");function G({url:s,async:e=!1,onError:t=a(o=>p.warn(o),"onError")}){let o=new C({url:s,onError:t});return new w({transport:o,async:e})}a(G,"createChannel");f();var me=h(ne()),pe=h(se());var J={react:me,"react-dom":pe,"@storybook/components":Y,"@storybook/channels":H,"@storybook/core-events":y,"@storybook/router":D,"@storybook/theming":B,"@storybook/api":P,"@storybook/addons":U,"@storybook/client-logger":I};var{FEATURES:de,SERVER_CHANNEL_URL:z}=R.default,ue=a(class extends j{constructor(){super();let e=_({page:"manager"});if(v.setChannel(e),e.emit(K.CHANNEL_CREATED),this.addons=v,this.channel=e,de?.storyStoreV7&&z){let t=G({url:z});this.serverChannel=t,v.setServerChannel(this.serverChannel)}}getElements(e){return this.addons.getElements(e)}getConfig(){return this.addons.getConfig()}handleAPI(e){this.addons.loadAddons(e)}},"ReactProvider"),{document:ge}=R.default,ye=ge.getElementById("root");q(ye,new ue);Object.keys(T).forEach(s=>{R.default[T[s]]=J[s]});
